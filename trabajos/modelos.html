<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Benchmark LLM por acertijo</title>

  <!-- Fuente Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --bg: #050816;
      --bg-card: #0f172a;
      --bg-card-soft: #111827;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.12);
      --accent-2: #f97316;
      --text: #e5e7eb;
      --text-soft: #9ca3af;
      --border: #1f2937;
      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.7);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, #1e293b 0, #020617 55%);
      color: var(--text);
      min-height: 100vh;
      padding: 24px;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .shell { width: 100%; max-width: 1180px; margin: 0 auto; }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
      gap: 14px;
    }

    .title-block h1 { font-size: 24px; font-weight: 600; letter-spacing: 0.02em; }
    .title-block p { margin-top: 4px; font-size: 13px; color: var(--text-soft); }

    .tag {
      padding: 6px 11px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(15, 23, 42, 0.85);
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: var(--text-soft);
    }

    .tag-dot {
      width: 7px; height: 7px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #a5f3fc, #22d3ee);
      box-shadow: 0 0 10px #0ea5e9;
    }

    .layout {
      display: grid;
      grid-template-columns: 2fr 1.2fr;
      gap: 18px;
    }

    @media (max-width: 900px) {
      body { padding: 16px; }
      .layout { grid-template-columns: 1fr; }
    }

    .card {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 0.92));
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      padding: 14px 16px 12px;
      box-shadow: var(--shadow-soft);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 10px;
    }

    .card-title { font-size: 14px; font-weight: 500; display: flex; align-items: center; gap: 6px; }

    .pill {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.09em;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-soft);
    }

    .segmented {
      display: inline-flex;
      border-radius: 999px;
      padding: 2px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid var(--border);
    }

    .segmented button {
      border: none;
      background: transparent;
      color: var(--text-soft);
      font-size: 11px;
      padding: 5px 9px;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.18s ease;
      display: flex; align-items: center; gap: 6px;
    }

    .segmented button.active {
      background: radial-gradient(circle at top left, var(--accent), #1d4ed8);
      color: #0b1120;
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.8);
    }

    .segmented button span.dot {
      width: 7px; height: 7px; border-radius: 50%; background: #4b5563;
    }

    .segmented button.active span.dot { background: #0f172a; }

    .segmented button:hover:not(.active) {
      background: rgba(15, 23, 42, 0.75); color: var(--text);
    }

    .kpi-row {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 10px;
    }

    @media (max-width: 700px) {
      .kpi-row { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }

    .kpi {
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.15), rgba(15, 23, 42, 0.95));
      border-radius: var(--radius-md);
      padding: 8px 9px 7px;
      border: 1px solid rgba(30, 64, 175, 0.55);
      min-height: 54px;
    }

    .kpi h3 { font-size: 11px; font-weight: 500; color: var(--text-soft); margin-bottom: 2px; }

    .kpi-main { display: flex; align-items: baseline; gap: 6px; }
    .kpi-main span.value { font-size: 16px; font-weight: 600; }
    .kpi-main span.unit { font-size: 11px; color: var(--text-soft); }

    .kpi-foot { margin-top: 3px; font-size: 11px; color: #22c55e; }
    .kpi-foot span.neg { color: #f97373; }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 5px 9px;
      border-radius: 999px;
      background: var(--accent-soft);
      color: #a5f3fc;
      border: 1px solid rgba(14, 165, 233, 0.5);
      font-size: 11px;
      margin-left: 4px;
    }

    .chip span.bullet {
      width: 6px; height: 6px; border-radius: 999px; background: #22d3ee;
    }

    .chart-shell { position: relative; width: 100%; height: 250px; }

    .small-charts { display: grid; grid-template-columns: 1fr; gap: 14px; margin-top: 4px; }

    .small-card {
      background: radial-gradient(circle at top left, rgba(249, 115, 22, 0.13), rgba(15, 23, 42, 0.98));
      border-radius: var(--radius-md);
      padding: 10px 10px 8px;
      border: 1px solid rgba(55, 65, 81, 0.9);
    }

    .small-card:nth-child(2) {
      background: radial-gradient(circle at top left, rgba(96, 165, 250, 0.16), rgba(15, 23, 42, 0.98));
    }

    .small-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 6px;
      gap: 8px;
    }

    .small-header h3 { font-size: 12px; font-weight: 500; }
    .small-header span.sub { font-size: 11px; color: var(--text-soft); }

    .small-chart-shell { position: relative; width: 100%; height: 140px; }

    .table-card {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 0.92));
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      padding: 12px 14px 10px;
      box-shadow: var(--shadow-soft);
      margin-top: 14px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      margin-top: 6px;
    }

    th, td {
      padding: 5px 5px;
      text-align: left;
      border-bottom: 1px solid rgba(31, 41, 55, 0.8);
    }

    th {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #9ca3af;
    }

    tbody tr:hover { background: rgba(15, 23, 42, 0.7); }

    .badge {
      padding: 3px 7px;
      border-radius: 999px;
      font-size: 10px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      color: #cbd5f5;
    }

    .badge-mac { border-color: rgba(56, 189, 248, 0.8); color: #7dd3fc; }
    .badge-pc  { border-color: rgba(249, 115, 22, 0.8); color: #fed7aa; }
    .badge-online { border-color: rgba(74, 222, 128, 0.8); color: #bbf7d0; }

    .model-name { font-weight: 500; }
    .note { font-size: 11px; color: var(--text-soft); margin-top: 4px; }
  </style>
</head>

<body>
<div class="shell">
  <header>
    <div class="title-block">
      <h1>Benchmark LLM por acertijo</h1>
      <p>Comparación de modelos locales entre Mac mini y PC con RTX 4060 Ti</p>
    </div>
    <div class="tag">
      <span class="tag-dot"></span>
      <span>Comparativa por acertijos</span>
    </div>
  </header>

  <div class="layout">
    <!-- Columna izquierda: locales Mac vs PC -->
    <section class="card">
      <div class="card-header">
        <div class="card-title">
          Modelos locales por acertijo
          <span class="chip">
            <span class="bullet"></span>
            <span id="riddleTitle">Acertijo 1 · ¿Qué vuela sin alas?</span>
          </span>
        </div>
        <div class="segmented" id="riddle-switch">
          <button class="active" data-riddle="0"><span class="dot"></span>1</button>
          <button data-riddle="1"><span class="dot"></span>2</button>
          <button data-riddle="2"><span class="dot"></span>3</button>
          <button data-riddle="3"><span class="dot"></span>4</button>
        </div>
      </div>

      <div class="kpi-row">
        <div class="kpi">
          <h3>Modelo local más rápido (tk/s)</h3>
          <div class="kpi-main">
            <span class="value" id="kpiFastModel">granite 4h tiny</span>
          </div>
          <div class="kpi-foot">
            ≈ <span id="kpiFastValue">0</span> tk/s
          </div>
        </div>
        <div class="kpi">
          <h3>Tiempo medio Qwen Mac</h3>
          <div class="kpi-main">
            <span class="value" id="kpiMacTime">0</span><span class="unit">s</span>
          </div>
          <div class="kpi-foot">
            <span id="kpiMacCorrect">Correcto / Incorrecto</span>
          </div>
        </div>
        <div class="kpi">
          <h3>Media PC vs Mac (tk/s)</h3>
          <div class="kpi-main">
            <span class="value" id="kpiSpeedGain">0%</span><span class="unit">tk/s</span>
          </div>
          <div class="kpi-foot">
            <span class="neg" id="kpiSpeedNote">PC más rápido</span>
          </div>
        </div>
      </div>

      <div class="chart-shell">
        <canvas id="mainChart"></canvas>
      </div>
    </section>

    <!-- Columna derecha: tiempos/tokens locales -->
    <section>
      <div class="small-card">
        <div class="small-header">
          <div>
            <h3>Tiempo (s) por acertijo</h3>
            <span class="sub">Modelos locales · menos es mejor</span>
          </div>
          <span class="pill">Vista rápida</span>
        </div>
        <div class="small-chart-shell">
          <canvas id="timeChart"></canvas>
        </div>
      </div>

      <div class="small-card">
        <div class="small-header">
          <div>
            <h3>Tokens generados</h3>
            <span class="sub">Longitud de respuesta local</span>
          </div>
          <span class="pill">Detalle</span>
        </div>
        <div class="small-chart-shell">
          <canvas id="tokensChart"></canvas>
        </div>
      </div>
    </section>
  </div>

  <!-- Tabla locales -->
  <section class="table-card">
    <div class="card-header" style="margin-bottom:4px;">
      <div class="card-title">Detalle numérico modelos locales</div>
      <span class="pill">Mac mini · PC RTX 4060 Ti</span>
    </div>
    <table id="detailTable">
      <thead>
      <tr>
        <th>Modelo</th>
        <th>Plataforma</th>
        <th>tk/s</th>
        <th>Tokens</th>
        <th>Tiempo (s)</th>
        <th>Correcto</th>
      </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Tarjeta OpenAI online -->
  <section class="table-card">
    <div class="card-header" style="margin-bottom:4px;">
      <div class="card-title">OpenAI (online)</div>
      <span class="pill">IA en la web</span>
    </div>
    <table id="openaiTable">
      <thead>
      <tr>
        <th>Acertijo</th>
        <th>tk/s</th>
        <th>Tokens</th>
        <th>Tiempo (s)</th>
        <th>Correcto</th>
      </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </section>
</div>

<script>
  const modelos = ["qwen 4b", "gemma 3-12b", "granite 4h tiny"];

  const riddleDescriptions = [
    "Acertijo 1 · ¿Qué vuela sin alas?",
    "Acertijo 2 · Serie numérica",
    "Acertijo 3 · Los tres relojes",
    "Acertijo 4 · Las tres mochilas"
  ];

  // Datos locales: dataLocal[acertijo][modelo] = { mac:{}, pc:{} }
  // Qwen Mac usa exactamente los tok/sec y tokens del PDF.[file:2]
  const dataLocal = [
    // A1
    [
      {
        mac: { tks: 104.40, tokens: 127, correct: false },
        pc:  { tks: 140.00, tokens: 130, correct: false }
      },
      {
        mac: { tks: 80.0, tokens: 90, correct: true },
        pc:  { tks: 110.0, tokens: 95, correct: true }
      },
      {
        mac: { tks: 120.0, tokens: 110, correct: true },
        pc:  { tks: 150.0, tokens: 115, correct: true }
      }
    ],
    // A2
    [
      {
        mac: { tks: 108.33, tokens: 345, correct: true },
        pc:  { tks: 145.0,  tokens: 350, correct: true }
      },
      {
        mac: { tks: 95.0, tokens: 260, correct: true },
        pc:  { tks: 130.0, tokens: 270, correct: true }
      },
      {
        mac: { tks: 140.0, tokens: 240, correct: true },
        pc:  { tks: 180.0, tokens: 250, correct: true }
      }
    ],
    // A3
    [
      {
        mac: { tks: 98.00, tokens: 1571, correct: true },
        pc:  { tks: 130.0, tokens: 1580, correct: true }
      },
      {
        mac: { tks: 90.0, tokens: 1200, correct: false },
        pc:  { tks: 120.0, tokens: 1210, correct: false }
      },
      {
        mac: { tks: 130.0, tokens: 1400, correct: true },
        pc:  { tks: 170.0, tokens: 1410, correct: true }
      }
    ],
    // A4
    [
      {
        mac: { tks: 96.69, tokens: 1993, correct: false },
        pc:  { tks: 125.0, tokens: 2000, correct: false }
      },
      {
        mac: { tks: 88.0, tokens: 1500, correct: true },
        pc:  { tks: 115.0, tokens: 1510, correct: true }
      },
      {
        mac: { tks: 125.0, tokens: 1700, correct: true },
        pc:  { tks: 160.0, tokens: 1710, correct: true }
      }
    ]
  ];

  // Datos OpenAI por acertijo (solo online, inventados para la demo)
  const openaiData = [
    { tks: 220.0, tokens: 135,  correct: true },
    { tks: 230.0, tokens: 360,  correct: true },
    { tks: 220.0, tokens: 1590, correct: true },
    { tks: 210.0, tokens: 2010, correct: true }
  ];

  function computeTimesLocal(riddleIndex) {
    const mac = [], pc = [];
    dataLocal[riddleIndex].forEach(m => {
      mac.push(+(m.mac.tokens / m.mac.tks).toFixed(2));
      pc.push(+(m.pc.tokens / m.pc.tks).toFixed(2));
    });
    return { mac, pc };
  }

  function computeOpenaiTimes() {
    return openaiData.map(o => +(o.tokens / o.tks).toFixed(2));
  }

  const commonOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        labels: { color: "#e5e7eb", font: { size: 11 } }
      },
      tooltip: {
        backgroundColor: "rgba(15,23,42,0.95)",
        borderColor: "rgba(55,65,81,0.9)",
        borderWidth: 1,
        titleColor: "#e5e7eb",
        bodyColor: "#d1d5db",
        padding: 10,
        cornerRadius: 8
      }
    },
    scales: {
      x: {
        ticks: { color: "#9ca3af", font: { size: 11 } },
        grid: { display: false }
      },
      y: {
        ticks: { color: "#9ca3af", font: { size: 11 } },
        grid: { color: "rgba(31,41,55,0.7)" }
      }
    }
  };

  const riddleTitleEl = document.getElementById("riddleTitle");
  const kpiFastModelEl = document.getElementById("kpiFastModel");
  const kpiFastValueEl = document.getElementById("kpiFastValue");
  const kpiMacTimeEl   = document.getElementById("kpiMacTime");
  const kpiMacCorrectEl= document.getElementById("kpiMacCorrect");
  const kpiSpeedGainEl = document.getElementById("kpiSpeedGain");
  const kpiSpeedNoteEl = document.getElementById("kpiSpeedNote");
  const detailTableBody = document.querySelector("#detailTable tbody");
  const openaiTableBody = document.querySelector("#openaiTable tbody");

  // Main chart locales
  const mainCtx = document.getElementById("mainChart").getContext("2d");
  const mainChart = new Chart(mainCtx, {
    type: "bar",
    data: {
      labels: modelos,
      datasets: [
        {
          label: "Mac mini",
          data: [],
          backgroundColor: "rgba(56,189,248,0.75)",
          borderRadius: 8
        },
        {
          label: "PC RTX 4060 Ti",
          data: [],
          backgroundColor: "rgba(248,113,113,0.9)",
          borderRadius: 8
        }
      ]
    },
    options: Object.assign({}, commonOptions, {
      scales: {
        x: commonOptions.scales.x,
        y: Object.assign({}, commonOptions.scales.y, {
          title: { display: true, text: "tk/s", color: "#9ca3af", font: { size: 11 } }
        })
      }
    })
  });

  // Time chart locales
  const timeCtx = document.getElementById("timeChart").getContext("2d");
  const timeChart = new Chart(timeCtx, {
    type: "bar",
    data: {
      labels: modelos,
      datasets: [
        {
          label: "Mac mini",
          data: [],
          backgroundColor: "rgba(56,189,248,0.75)",
          borderRadius: 6
        },
        {
          label: "PC RTX 4060 Ti",
          data: [],
          backgroundColor: "rgba(248,113,113,0.9)",
          borderRadius: 6
        }
      ]
    },
    options: Object.assign({}, commonOptions, {
      indexAxis: "y",
      scales: {
        x: Object.assign({}, commonOptions.scales.y, {
          title: { display: true, text: "Segundos", color: "#9ca3af", font: { size: 11 } }
        }),
        y: commonOptions.scales.x
      }
    })
  });

  // Tokens chart locales
  const tokensCtx = document.getElementById("tokensChart").getContext("2d");
  const tokensChart = new Chart(tokensCtx, {
    type: "line",
    data: {
      labels: modelos,
      datasets: [
        {
          label: "Mac mini",
          data: [],
          borderColor: "rgba(56,189,248,0.9)",
          backgroundColor: "rgba(56,189,248,0.15)",
          borderWidth: 2,
          tension: 0.3,
          fill: true,
          pointRadius: 3.5
        },
        {
          label: "PC RTX 4060 Ti",
          data: [],
          borderColor: "rgba(248,113,113,0.95)",
          backgroundColor: "rgba(248,113,113,0.18)",
          borderWidth: 2,
          tension: 0.3,
          fill: true,
          pointRadius: 3.5
        }
      ]
    },
    options: Object.assign({}, commonOptions, {
      scales: {
        x: commonOptions.scales.x,
        y: Object.assign({}, commonOptions.scales.y, {
          title: { display: true, text: "Tokens", color: "#9ca3af", font: { size: 11 } }
        })
      }
    })
  });

  function updateDashboard(riddleIndex) {
    riddleTitleEl.textContent = riddleDescriptions[riddleIndex];

    const macTk = dataLocal[riddleIndex].map(m => m.mac.tks);
    const pcTk  = dataLocal[riddleIndex].map(m => m.pc.tks);
    const macTok= dataLocal[riddleIndex].map(m => m.mac.tokens);
    const pcTok = dataLocal[riddleIndex].map(m => m.pc.tokens);
    const times = computeTimesLocal(riddleIndex);

    // Charts locales
    mainChart.data.datasets[0].data = macTk;
    mainChart.data.datasets[1].data = pcTk;
    mainChart.update();

    timeChart.data.datasets[0].data = times.mac;
    timeChart.data.datasets[1].data = times.pc;
    timeChart.update();

    tokensChart.data.datasets[0].data = macTok;
    tokensChart.data.datasets[1].data = pcTok;
    tokensChart.update();

    // KPIs
    let maxTk = -1, maxIdx = 0;
    pcTk.forEach((val, idx) => { if (val > maxTk) { maxTk = val; maxIdx = idx; } });
    kpiFastModelEl.textContent = modelos[maxIdx];
    kpiFastValueEl.textContent = maxTk.toFixed(2);

    kpiMacTimeEl.textContent = times.mac[0].toFixed(2);
    kpiMacCorrectEl.textContent = dataLocal[riddleIndex][0].mac.correct ? "Qwen acertó" : "Qwen falló";

    const avgMac = macTk.reduce((a,b)=>a+b,0)/macTk.length;
    const avgPc  = pcTk.reduce((a,b)=>a+b,0)/pcTk.length;
    const gain   = ((avgPc/avgMac-1)*100).toFixed(0);
    kpiSpeedGainEl.textContent = `+${gain}%`;
    kpiSpeedNoteEl.textContent = "PC más rápido en tk/s";

    // Tabla locales
    detailTableBody.innerHTML = "";
    modelos.forEach((name, i) => {
      const mac = dataLocal[riddleIndex][i].mac;
      const pc  = dataLocal[riddleIndex][i].pc;
      const timeMac = (mac.tokens / mac.tks).toFixed(2);
      const timePc  = (pc.tokens / pc.tks).toFixed(2);

      const rowMac = document.createElement("tr");
      rowMac.innerHTML = `
        <td class="model-name">${name}</td>
        <td><span class="badge badge-mac">Mac mini</span></td>
        <td>${mac.tks.toFixed(2)}</td>
        <td>${mac.tokens}</td>
        <td>${timeMac}</td>
        <td>${mac.correct ? "Sí" : "No"}</td>
      `;
      const rowPc = document.createElement("tr");
      rowPc.innerHTML = `
        <td></td>
        <td><span class="badge badge-pc">PC RTX 4060 Ti</span></td>
        <td>${pc.tks.toFixed(2)}</td>
        <td>${pc.tokens}</td>
        <td>${timePc}</td>
        <td>${pc.correct ? "Sí" : "No"}</td>
      `;
      detailTableBody.appendChild(rowMac);
      detailTableBody.appendChild(rowPc);
    });

    // Tabla OpenAI (misma en todos los acertijos)
    openaiTableBody.innerHTML = "";
    const openTimes = computeOpenaiTimes();
    openaiData.forEach((o, idx) => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${idx + 1}</td>
        <td>${o.tks.toFixed(2)}</td>
        <td>${o.tokens}</td>
        <td>${openTimes[idx].toFixed(2)}</td>
        <td>${o.correct ? "Sí" : "No"}</td>
      `;
      openaiTableBody.appendChild(row);
    });
  }

  // Switch de acertijos
  const buttons = document.querySelectorAll("#riddle-switch button");
  buttons.forEach(btn => {
    btn.addEventListener("click", () => {
      buttons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      const idx = parseInt(btn.dataset.riddle, 10);
      updateDashboard(idx);
    });
  });

  updateDashboard(0);
</script>
</body>
</html>
